[전체 기획]
언리얼 엔진5 블루프린트와 c++의 혼용으로 "Lost Ark"게임의 보스레이드 모작

[주요 목표]
블루프린트와 c++를 활용하여 LostArk 게임의 보스레이드 모작을 진행하나 블루프린트를 활용하면 효율적인 부분에는 블루프린트, c++을 활용하면 효율적인 부분에는 c++를 적용시켜
만드는것이 목표. 다만, Lyra의 프레임워크를 따라갈것임. Lyra에서 가져온 플러그인으로 Game Ability System, Modular Gameplay, Modular Gameplay Actors, CommonUI, UIExtension,
CommonGame, CommonUser, GamePlayMessageRouter가 있음. gamefeature의 경우 이번프로젝트에서는 적용하지않으나 Lyra의 철학인 모듈화는 따라감. Experience는 프로젝트에
적용. 원작의 경우 4인 멀티 파티로 진행하는게 일반적이나 이번 프로젝트에서는 싱글로 진행. (보스와 플레이어의 1:1)

[현재 보유 에셋]
보스 몬스터 : Contents/ParagonSevarog
Sevarog 보유 모션 ( 
(일반)Cast - 보스 전방에 장판 생성, 
(일반)Clap - 3연장판,
(일반)Launchpad - 주변데미지,
(특수 체력 70%)Emote_Pointing_MC_T3 - 주변에 장판이 마구잡이로 생성, 
(보스와 일정거리 이상 멀어지면 발동)Emote_pull_MC_T1 - 거리가 너무 멀어질시 강제로 플레이어가 보스앞으로 당겨와짐 , 
(일반)Speedburst - 몸통박치기, 
(특수 체력 40%)Soul_Siphon - 플레이어에게 저주, 
(플레이어 다운시)Subjugation - 플레이어 발밑에 장판 생성, 
(일반콤보)Swing1, Swing2,  Swing3 - 보스 일반 연계 콤보, 
(특수 체력 10%)Ultimate_Swing - 타게팅모션 보유
)

플레이어 : Contents/ParagonKwang
kwang 보유 모션 ( 칼던지고 받기, 회전하며 베기, 칼 앞으로 쥐며 힘모으기, 평타a, 평타b, 평타c, 평타d, 귀환)

[구현 목표]
프로그램 실행시 캐릭터 선택창에서 ParagonKwang 캐릭터 선택가능. 선택후 게임시작 버튼 클릭시 보스가 있는 레벨 진입. 보스는 플레이어에게 랜덤하게 일반패턴 진행,
일정시간마다 시간제 패턴 진행, 일정 피가 되면 특수패턴진행. 플레이어는 스페이스바 회피, qwerasdf칸에 할당된 총 8개의 전투, 버프 스킬 사용가능. 
새로운 레이드가 시작할 때 마다 1000골드 배정. 상점에서 배틀아이템(소모품) 구매 가능, (HP포션,일정시간 공격력을 상승시키는 아드로핀, 적이 받는 데미지를 증폭시켜주는 암흑수류탄, 적에게 약한 데미지와 무력화 수치를 감소시키는 회오리 수류탄, 3초동안 움직이지 못하지만 아무 데미지도 받지않는 시간정지물약)
인벤토리에 5종류의 아이템을 쌓아 놓을 수 있지만 보스와의 전투시 들고 갈 수 있는 배틀아이템은 총 4종류.
1234칸에 배정된 배틀아이템 사용가능, 각 배틀아이템은 최대로 들고 갈 수 있는 개수가 정해져 있음 (hp포션 7개, 아드로핀 2개, 암흑수류탄 3개, 회오리수류탄 3개, 시간정지물약 2개)
보스 처치시 짧은 승리모션후 게임종료

[플레이어 캐릭터 기획]
  1. 클래스 컨셉 (Class Concept)
   * 키워드: 번개, 대검, 폭발적인 기동성
   * 전투 스타일: 거대한 검을 휘두르는 묵직한 근접 공격과 번개를 떨어뜨리는 중거리 마법을 섞어 사용합니다. 빠른 돌진기로 진입하여 강력한 한 방을 꽂는 '돌격형 딜러'입니다.
   * 아이덴티티 (Identity - Z키): 뇌전 충전 (Overcharge)
       * 적을 타격하여 게이지를 채웁니다.
       * Z키 발동 시 20초간 '뇌신 모드'에 돌입.
       * 효과: 공격 속도 20% 증가, 스킬 쿨타임 30% 감소, 모든 스킬 이펙트가 푸른색에서 붉은색 번개로 강화.

  ---

  2. 스킬 구성 (8 Skills + 1 Awakening)

  로스트아크는 스킬 타입(콤보, 지점, 홀딩, 차징, 일반)이 다양해야 재미가 있습니다. 광(Kwang)의 애니메이션을 최대한 활용할 수 있도록 구성했습니다.

  [Q] 뇌명 (Thunder Flash) - 콤보 (anim : Combo_Attack_02)
   * 타입: 콤보 (4회 입력) / 주력기
   * 설명:
       1. 전방으로 짧게 몸을 돌려 적을 벱니다.
       2. 재입력 시 검을 위로 쳐올리고 내려벱니다.
       3. 전방으로 짧게 검을 찌릅니다.
       4. 몸을 크게 돌려 검을 휘두릅니다.
   * 특수 효과: 피격 이상 면역(슈퍼아머 - 경직 무시).

  [W] 낙뢰참 (Lightning Cleave) - 일반 / 견제기 (anim : ability_R) (area : NS_DynamicCollisionVFX5)
   * 타입: 일반
   * 설명: 제자리에서 검을 휘두름과 동시에 전방 부채꼴 범위에 번개를 뿌립니다. 적중된 적은 8초간 받는피해가 6%증가합니다.
   * 특수 효과: 시너지스킬, 적에게 받는피해 6%증가 부여

  [E] 벼락의 심판 (Judgement) - 지점 / 원거리 (anim : ability_Q_throw)
   * 타입: 지점 조작 (Point & Click)
   * 설명: 마우스 커서 위치에 검을 공중에서 소환해 꽂아버립니다. 꽂힌 검 주변에 지속적인 번개 장판 데미지를 줍니다.

  [R] 뇌룡승천 (Rising Dragon) - 콤보 / 광역 딜링 (anim : Attack_UP_Floor_To_Air_02_Seq & Attack_Air_to_Floor_01)
   * 타입: 콤보 (2타)
   * 설명:
       1. 회전하며 뛰어올라 1차적으로 데미지를 줍니다.
       2. 검을 내려꽂으며 주변에 충격파를 발생시킵니다.

   * 특수 효과: 무력화(중).

  [A] 전광석화 (Flash Step) - 카운터 / 이동기 (anim : Run_Attack_01_Seq)
   * 타입: 일반
   * 설명: 몸과 검을 회전시키며 앞으로 돌진합니다.
   * 특수 효과: 카운터 어택 (보스의 전조 동작 시 맞추면 무력화), 피격 이상 면역.

  [S] 뇌전 폭풍 (Storm Blade) - 홀딩 / 광역기 (anim : Recall)
   * 타입: 홀딩 (키 지속)
   * 설명: 제자리에서 검을 머리 위로 핑핑 돌리며 주변 적들을 끌어당기는 회오리를 생성합니다. 키를 놓거나 지속 시간이 끝나면 회오리가 흩어집니다.

  [D] 뇌신의 가호 (Thunder Shield) - 버프 / 쉴드 (anim : ability_RMB)
   * 타입: 일반
   * 설명: 검을 자신의 앞에 두손으로 쥐며 자신에게 번개 보호막을 씌웁니다.
   * 효과: 6초간 최대 체력의 15% 쉴드 생성 + 매 초마다 주변 적에게 데미지를 줌

  [F] 천둥 벼락 (Heaven's Fury) - 차징 / 일반필살기 (anim : execution_03_Seq)
   * 타입: 차징 (게이지 충전)
   * 설명: 기를 모아 번개 에너지를 응축시킵니다. (차징 중 이동 불가, 방향 전환 가능)
       * 오버차지(Perfect Zone) 성공 시: 전방으로 지면에 주먹을 내리쳐 충격파를 발생시킵니다.
   * 특수 효과: 무력화(최상)

  ---

  3. 각성기 (Awakening - V키) (각성기 보류)

/*
  [V] 뇌신강림 : 라그나로크 (God of Thunder: Ragnarok)
   * 연출: 카메라가 줌아웃되며, 캐릭터가 공중으로 높이 솟구칩니다. 구름 위에서 거대한 뇌신(혹은 거대화된 검)의 형상이 나타나 지상을 향해 멸망의 벼락을 내리꽂습니다.
   * 효과: 화면 전체 범위에 막대한 데미지를 입힙니다.
   * 특수: 사용 후 아이덴티티 게이지 100% 회복.
*/

  ---

 4. Kwang 에셋을 활용한 평타 기획 (4단 콤보)

   * 1타 (좌클릭): 우측에서 좌측으로 대각선 베어올리기.
   * 2타 (좌클릭): 좌측에서 우측으로 대각선 베어올리기.
   * 3타 (좌클릭): 우측에서 좌측으로 대각선 베어내리기.
   * 4타 (좌클릭 - 피니시): 좌측에서 우측으로 수평베기.

  < 기술적 구현 포인트 >

   1. 후딜 캔슬 (Animation Cancel):
       * 평타 4타를 치는 도중에 스킬(Q, W...)이나 회피기(Space)를 쓰면, 평타 모션이 즉시 취소되고 스킬이 나가야 합니다. 이 반응성이 없으면 조작감이 매우 답답해집니다.
   2. 오토 타겟 보정 (Auto Targeting / Magnetism):
       * 로스트아크는 마우스 방향으로 공격하지만, 근처에 적이 있으면 살짝 회전해서 맞춰줍니다. 평타 사용 시 아주 약하게 가장 가까운 적 방향으로 캐릭터를 회전시키는(targeting system & motion warping) 기능을 넣으면 타격감이 훨씬 좋아집니다.

[5주 로드맵]

 * 1주차: C++ Core & Camera (Foundation)
     * Build.cs 모듈 설정 (GAS, CommonUI 등).
     * C++: AMyCPPProjectCharacter 생성, PlayerStae(GAS 초기화 포함), AMyCPPProjectController (클릭 이동).
     * C++: ACPPProjectGameMode.
     * Blueprint: 쿼터뷰 카메라 및 입력 매핑(IMC).
     * Paragon Kwang: 리타겟팅 및 캐릭터 BP 적용.
 * 2주차: C++ GAS Combat System
     * C++: AttributeSet (HP, MP, IdentityGauge, Stagger).
     * C++: GameplayAbility Base Class (스킬 쿨타임, 비용 로직).
     * Abilities: 평타(Combo), 스킬 구현.
 * 3주차: C++ Boss AI (Sevarog)
     * C++: AIController, BTTask (Custom Logic).
     * Pattern: 페이즈 전환, 광역기, 어그로 시스템.
 * 4주차: UI & System
     * C++: CommonActivatableWidget을 상속받은 HUD 클래스.
     * UI: 체력바, 데미지 플로팅, 스킬 슬롯.
 * 5주차: Polish
     * VFX, SFX, 타격감 개선 (HitStop).


[구현계획]
1. UMyPawnData (DataAsset)
 * 역할: "이 캐릭터는 어떤 Pawn 클래스이고, 어떤 스킬과 입력 설정을 쓰는가?"
 * 이동할 데이터:
     * PawnClass (BP_Kwang)
     * StartupAbilities (기존 Character에 있던 것)
     * InputConfig (기존 Character에 있던 것)

2. UMyExperienceDefinition (DataAsset)
 * 역할: "이 게임 모드는 어떤 PawnData를 기본으로 쓰는가?"
 * 포함할 데이터:
     * DefaultPawnData (UMyPawnData 포인터)
     * (나중에) HUDClass, ActionSets 등

3. UMyExperienceManagerComponent (GameStateComponent)
 * 역할: 게임 시작 시 지정된 ExperienceDefinition을 로드하고, 다른 클래스들이 "지금 무슨 모드야?"라고 물어보면 알려줍니다.

4. UMyHeroComponent (PawnComponent)
 * 역할: 캐릭터가 스폰되면 ExperienceManager에게 PawnData를 달라고 요청한 뒤, GAS 초기화(InitAbilityActorInfo) + 스킬 부여(GrantAbility) + 입력 바인딩(BindInput)을 수행합니다.
 * 결과: 기존 AMyCPPProjectCharacter에 있던 복잡한 로직들이 싹 사라지고 이 컴포넌트로 이동합니다.

# 주간 요약 (2주차)

1. 플레이어 캐릭터 (Kwang) : 전투 시스템 완성
GAS(Gameplay Ability System)를 기반으로 QWERASDF 총 8종의 스킬과 평타, 회피를 모두 구현하였으며, '로스트아크' 특유의 조작감을 살리기 위한 디테일한 로직을 C++로 완성했습니다.
    
      스킬 메커니즘 구현:
    
    - 콤보 (Q, 평타): 선입력(Input Buffering) 및 애니메이션 캔슬 지원.
    - 차징 (F): GetRealTimeSeconds를 활용한 차징 단계별(일반/오버차지) 분기 처리.
    - 홀딩 (S): Wait Input Release를 활용한 키 지속형 스킬 구현.
    - 지점 (E): GetHeroCursorHit을 통한 마우스 커서 위치 장판 소환(AMyAoEActor).
    - 이동/돌진 (A, Space): 루트 모션 활용 및 마우스 방향 회전(RotateToCursor) 적용.
    - 공중 콤보 (R): LaunchCharacter 및 중력 조절로 도약/강습 구현.
2. 시스템 아키텍처 & UI : Lyra 스타일 도입. 확장성과 유지보수성을 고려한 Lyra 프레임워크의 철학(Modular, Decoupling)을 프로젝트에 이식했습니다.
- UI 시스템 구축:
    - PrimaryGameLayout 도입으로 레이어(Game, Menu, Modal) 기반 관리 시스템 구축.
    - CommonUserWidget 기반 HUD 및 보스 체력바 구현.
- 느슨한 결합 (Decoupling):
    - GameplayMessageSubsystem을 활용하여 보스(Actor)와 UI(Widget) 간의 직접 참조를 끊고 메시지 기반으로 통신하도록 설계.
    - 초기화 타이밍 이슈(Race Condition) 해결.
- 데이터 관리:
    - 싱글톤 패턴의 태그 관리 클래스(FMyGameplayTags) 도입.
3. 보스 몬스터 (Sevarog) : 기반 마련
보스전 진행을 위한 기초 공사를 마쳤습니다.
- 기본 세팅: AModularCharacter 상속 및 GAS(ASC, AttributeSet) 연동 완료.
- 판정 시스템: AnimNotifyState를 C++로 확장하여 구체(Sphere), 부채꼴(Cone), 광역(Radial) 등 다양한 피격 판정 로직 구현.
- 초기화: GE_BossInit을 통한 스탯 초기화 및 UI 연동.


  📅 주간 개발 요약 (3주차: 보스 레이드 핵심 시스템 구축)

  1. 코어 아키텍처 및 최적화 (Core & Optimization)
   * 네이티브 태그 전환: 문자열 기반 검색의 병목 현상을 해결하기 위해 UE_DEFINE_GAMEPLAY_TAG 방식의 Native Gameplay Tags로 전면 교체하여 태그 연산 속도를 극대화했습니다.
   * 메시지 기반 UI 시스템: UI가 보스를 직접 참조하지 않고 GameplayMessageRouter를 통해 체력 변화를 수신하는 느슨한 결합(Decoupling) 구조를 완성했습니다.
   * 데이터 주도 설계: MyPawnData를 통해 보스의 스탯, 스킬, 에셋을 데이터 에셋 하나로 관리할 수 있는 확장성을 확보했습니다.

  2. 보스 AI 및 전투 시스템 (AI & Combat)
   * 지능형 AI (BT): 체력 비율(페이즈), 거리(당기기), 확률(일반 공격)을 스스로 판단하여 패턴을 구사하는 Behavior Tree를 구축했습니다.
   * C++ 기반 스킬 모듈화: 전조(Telegraph) 생성 및 타격 판정 등 반복되는 로직을 C++ 베이스 클래스(UMyGameplayAbility_Boss)에 최적화하여 구현했습니다.
   * 일반 패턴 구현: Cast(장판), Clap(3연타), Speedburst(돌진), SwingCombo(연계기), Launchpad(주변 광역) 등 기본 패턴 5종을 완성했습니다.

  3. 페이즈 및 기믹 패턴 (Phase & Mechanics)
   * 70% 패턴 (Pointing): C++ 재귀 타이머를 활용한 무작위 장판 소환 패턴을 구현했습니다.
   * 40% 패턴 (Soul Siphon): 안전지대로 피신하지 못할 시 즉사하는 전멸기(Wipe) 기믹을 구현했습니다.
   * 무력화 시스템 (Stagger): 별도의 무력화 게이지(IncomingStagger)를 구축하고, 플레이어 스킬별로 무력화 수치를 배정하여 전략적인 전투가 가능케 했습니다.

  4. 고난도 연출 및 기능 (Advanced Features)
   * 10% 발악 패턴 (Ultimate Swing): 8초 내에 무력화를 시켜야 생존할 수 있는 타임어택 패턴을 구현했습니다.
   * 당기기 패턴 (Pull): 플레이어가 멀어지면 강제로 포획하여 2단계에 걸쳐 보스 앞으로 끌고 오는 AbilityTask 기반의 연출을 완성했습니다.
   * CC 및 입력 차단: GE_Stun과 컨트롤러 입력을 물리적으로 씹어버리는 차단 로직을 통해 확실한 군중 제어 효과를 구현했습니다.

  5. 시각 효과 및 타격감 (VFX & Feedback)
   * 전조 효과 (Telegraph): 공격 범위를 미리 알리는 데칼(Decal)과 타임라인 연출을 적용했습니다.
   * 패턴별 VFX: 당기기 시 플레이어를 붙잡는 유령 손(Cascade) 이펙트 등 주요 패턴에 시각적 피드백을 추가했습니다.

  📅 주간 개발 요약 보고서 (4주차 vfx, ui, 인벤토리 작업)


  1. 코어 시스템 및 아키텍처 (Lyra 스타일)
   * 모듈화 및 느슨한 결합: GameplayMessageRouter를 도입하여 보스(Actor)와 UI(Widget) 간의 직접 참조를 제거하고 메시지 기반으로 데이터를 교환하는 구조를 구축했습니다.
   * 데이터 주도 설계: MyPawnData, MyItemDefinition 등 Data Asset을 통해 캐릭터의 스탯, 스킬, 인벤토리 데이터를 코드 수정 없이 관리할 수 있도록 설계했습니다.
   * 네이티브 태그 전환: 성능 최적화와 안정성을 위해 모든 게임플레이 태그를 C++ UE_DEFINE_GAMEPLAY_TAG 기반의 Native Tags로 전면 교체했습니다.


  2. 전투 및 GAS (Gameplay Ability System)
   * 플레이어 스킬 시스템: LostArk의 조작감을 위해 다양한 스킬 타입(콤보, 차지, 홀딩, 지점 설치)을 C++ 기반 GAS로 구현했습니다.
   * 배틀 아이템 시스템:
       * InventoryComponent를 PlayerState에 부착하여 데이터 영속성을 확보했습니다.
       * 아이템 장착 시 해당 아이템의 GAS 어빌리티를 동적으로 부여(GiveAbility)하고 해제하는 로직을 완성했습니다.
       * 슬롯 인덱스를 입력 태그(InputTag.Item.1~4)를 통해 런타임에 계산하는 스마트한 아이템 사용 로직을 구축했습니다.
   * 무력화(Stagger) 시스템: 보스의 무력화 게이지를 별도로 구축하고, 플레이어의 스킬별로 무력화 배율을 적용하여 전략적 전투가 가능하게 했습니다.


  3. 보스 AI 및 패턴 (Sevarog)
   * 일반 패턴: 돌진(Speedburst), 장판(Cast), 3연타(SwingCombo) 등 5종 패턴 완성 및 전조(Telegraph) 데칼 이슈 해결.
   * 특수/전멸기 패턴:
       * 체력 70%: 무작위 광역 장판 패턴.
       * 체력 10%: 타임어택형 무력화 전멸기(Ultimate Swing) 및 VFX 연출.
       * 강제 기믹: 플레이어와 거리가 멀어질 시 강제로 당겨오는 Pull 패턴 및 AbilityTask 기반 이동 구현.


  4. UI 및 CommonUI 프레임워크
   * 레이어 기반 UI 관리: PrimaryGameLayout을 통해 HUD(Game), 인벤토리(Menu), 팝업(Modal) 레이어를 관리하는 Lyra 스타일 UI 스택을 정착시켰습니다.
   * 실시간 스탯 연동: AttributeSet(HP, MP) 변화를 UI에 실시간 반영하고, C++ Native Tick을 활용한 초고효율 스킬 쿨타임 시각화(스와이프, 타이머)를 구현했습니다.
   * 인벤토리/상점 UI: 드래그 앤 드롭을 통한 아이템 구매 및 장착 로직을 인터페이스(IMyItemWidgetInterface) 기반으로 표준화했습니다.


  5. 현재 직면한 과제 및 진행 상황
   * 이슈: 인벤토리 창을 닫은 후 마우스 커서가 사라지거나 입력이 간헐적으로 끊기는(포커스 실종) 현상이 발생 중입니다.
   * 원인: CommonUI의 ActionRouter가 메뉴 종료 시 뷰포트 포커스를 엔진 기본값(CapturePermanently)으로 초기화하는 과정에서 발생하는 Slate 레벨의 레이스 컨디션으로 파악되었습니다.
   * 진행 상태: SetInputMode, GetDesiredInputConfig, NativeOnActivated 등 다양한 방어 코드를 HUD(MyHUDLayout)에 적용하여 해결 중이며, 현재 마우스 커서는 유지되나 입력 반응성을 완벽하게 복구하는 단계에 있습니다.


---

 [02.09 한 일]


  1. 핵심 시스템 구조 (C++ Core)
   * 데이터 주도 설계: UMyItemDefinition(아이템 정보)과 UMyShopCollection(판매 목록) Data Asset 클래스 구축.
   * 인벤토리 관리: UMyInventoryComponent를 AMyCPPProjectPlayerState에 부착. 골드 관리, 전체 보유 아이템(TMap), 전투 슬롯 4개(TArray) 제어 로직 구현.
   * 메시지 기반 통신: GameplayMessageRouter를 통해 인벤토리 변경 시 FMyInventoryMessage를 방송. MyGameplayTags 싱글톤을 활용해 Message.Inventory.Updated 채널 사용.
   * 인터페이스 도입: IMyItemWidgetInterface를 생성하여 상점/인벤토리/HUD 슬롯이 동일한 함수(UpdateWidget)로 데이터를 주입받는 표준 규격 마련.


  2. UI 시스템 (CommonUI & UMG)
   * 통합 관리창: WBP_ShopManagementUI (부모: MyShopManagementWidget - CommonActivatableWidget).
   * 상점 시스템: WBP_Shop에서 InitializeShop 함수를 통해 데이터를 주입받아 WBP_InventorySlot을 동적 생성. bIsShopSlot 변수로 가격/개수 텍스트 가시성 제어.
   * 인벤토리 시스템: WBP_Inventory (부모: UMyInventoryWidget). C++에서 OwnedItems를 순회하며 그리드 패널을 자동으로 채우는 로직 구현.
   * HUD 연동: WBP_PlayerHUD 내 4개의 WBP_ItemSlot 배치. UMyItemSlotWidget이 UMySkillSlotWidget을 상속받아 GAS 기반 쿨타임 시각화 기능 공유.


  3. 상호작용 (Drag & Drop)
   * 드래그 데이터: UMyDragDropOperation(C++)을 정의하여 PayloadItem을 안전하게 전달.
   * 드래그 흐름: WBP_InventorySlot에서 드래그 시작 -> WBP_ItemSlot의 NativeOnDrop(C++)에서 수신 -> InventoryComponent->EquipItemToSlot 호출하여 장착 완료.


  4. 해결된 주요 이슈
   * Accessed None 오류: 인벤토리 컴포넌트 위치를 Pawn에서 PlayerState로 변경하여 데이터 영속성 및 참조 문제 해결.
   * UI 타이밍 문제: 부모 위젯이 자식 위젯(WBP_Shop)의 초기화 함수를 직접 호출하도록 하여 데이터 누락 방지.
   * 가시성(Visibility) 이슈: Visible 및 Hit Test Invisible 설정을 통해 드래그 앤 드롭 인식 문제 해결.

  ---

  A. 요약
  CommonUI와 GAS를 결합한 "로스트아크 스타일"의 배틀 아이템 시스템의 기틀을 완성했습니다. 상점에서 구매하여 인벤토리에 보관하고, 이를 드래그 앤 드롭으로 퀵슬롯에 장착하여 실제 스킬처럼 사용(쿨타임 및 개수
  차감 포함)하는 전체 파이프라인을 구축했습니다.

  ---

  B. 구현 완료 항목 (체크리스트)


   1. UI 포커스 및 마우스 이슈 해결
       * [C++] 인벤토리 폐쇄 시 CommonUI가 포커스를 빼앗는 현상을 OnDeactivated + NextTick 로직으로 해결. [1]
       * [Config] NoCapture, DoNotLock 설정을 통해 쿼터뷰 조작 편의성 확보.


   2. 드래그 앤 드롭 시스템 고도화
       * [C++] UMyDragDropOperation 확장 (출처/인덱스 정보 추가).
       * [C++] NativeOnDrop 분기 처리 (구매, 장착, 스왑 로직 통합).
       * [UX] WBP_ItemDragVisual 도입으로 클릭 차단 및 아이콘 찌그러짐 현상 해결. [2]


   3. 인벤토리 및 상점 로직 완성
       * [C++] SwapQuickSlots: 단순 배열 교체를 넘어 GAS 입력 태그 동적 갱신 로직 구현.
       * [C++] TryBuyItem: 골드 차감, 보유 수량 증가, 퀵슬롯 실시간 동기화 구현.
       * [UI] 인터페이스(IMyItemWidgetInterface) 기반의 데이터 주입 구조 확립.
       * [UI] 인벤토리 내 실시간 골드 표시 및 초기 데이터 로드 로직 추가.


   4. 배틀 아이템 어빌리티 (GAS)
       * [C++] MyGameplayAbility_Item: 슬롯 인덱스 자동 추적 및 ConsumeItem 연동.
       * [C++] 쿨타임 시스템: 일반 스킬과 동일한 SetByCaller 방식 이식. [3]
       * [BP] GA_Item_Potion: 인스턴싱 정책(InstancedPerActor) 및 실행 흐름 안정화.


  D. 현재 상태 및 한계


   * 진행 상태: 포션 사용 및 데이터 동기화까지 확인 완료.


  F. 출처
   * [엔진 소스] GameplayAbility.h: ApplyCooldown 및 CommitAbility를 통한 어빌리티 실행 제어 표준 방식 준수. [3]
   * [엔진 소스] UserWidget.h: NativeOnDrop 및 BindWidget을 활용한 UI-C++ 통신 구조.
   * [커뮤니티] CommonUI 포커스 복구는 SetTimerForNextTick을 사용하는 것이 UE5 프로젝트의 공통된 해결책임. [1]


[02.10 한일]
  1. 핵심 구현 내용 (C++ & GAS)
   * 아이템 시스템 구조:
       * 데이터: MyItemDefinition (아이템 정보), MyInventoryComponent (소지품/퀵슬롯 관리).
       * GAS: MyGameplayAbility_Item 베이스 클래스 구현. SetByCaller로 쿨타임/데미지/무력화 수치 동적 제어.
       * UI: MyItemSlotWidget이 MyPlayerHUDWidget을 통해 쿨타임 태그 변화(Cooldown.Item.1~4)를 감지하여 시각화(빙글빙글 효과).


   * 아이템별 기능 구현:
       * 포션 (`GA_Item_Potion`): ConsumeItem 후 체력 회복 GE 적용.
       * 수류탄 (`GA_Item_Grenade`): 투사체(AMyGrenadeProjectile) 스폰. SetByCaller로 계산된 데미지/무력화 Spec을 투사체에 전달 -> 충돌 시 타겟에게 적용.
       * 아드로핀 (`GA_Item_Adropine`): 버프(공/이속)와 디메리트(체력 감소) 동시 적용.
       * 시간 정지 (`GA_Item_TimeStop`): 3초간 무적/행동불가 태그(State.Invincible, State.Debuff.Stun) 적용 및 황금색 오버레이 머티리얼(GCNL_TimeStop) 연출.

  2. 해결된 주요 이슈 (디버깅 히스토리)
  이 부분은 다음 작업자가 시스템을 이해하는 데 매우 중요합니다.


   * ⚠️ 이슈 1: 1번 키 입력 시 모든 아이템 동시 발동
       * 원인: GAS가 동적 태그(InputTag.Item.1)만으로는 어빌리티 인스턴스를 구분하지 못하고, ClearAbility 타이밍 이슈로 슬롯에 여러 어빌리티가 중첩됨.
       * 해결: MyInventoryComponent::EquipItemToSlot에서 각 슬롯에 고유한 `InputID` (100 + SlotIndex)를 부여하여 물리적 입력 채널을 분리함.


   * ⚠️ 이슈 2: 쿨타임 UI 미작동 (빙글빙글 안 돔)
       * 원인: ApplyCooldown에서 태그를 넣었으나, GAS 시스템이 GetCooldownTags를 통해 이를 "공식 쿨타임 태그"로 인지하지 못해 이벤트를 발생시키지 않음.
       * 해결: MyGameplayAbility_Item::GetCooldownTags를 오버라이드하여, 현재 슬롯 인덱스에 맞는 태그(Cooldown.Item.1~4)를 반환하도록 수정함.


   * ⚠️ 이슈 3: 하나만 썼는데 모든 아이템이 쿨타임 걸림 (공유 쿨타임)
       * 원인: 쿨타임 GE(GE_Cooldown_Base) 에셋 자체에 Granted Tags가 설정되어 있어, 모든 아이템이 같은 태그를 공유함.
       * 해결: GE 에셋의 태그를 비우고, C++ ApplyCooldown에서 오직 해당 슬롯 태그만 동적으로 주입하도록 변경함.


  3. 파일 및 클래스 현황
   * C++:
       * MyInventoryComponent.cpp: 장착 시 InputID 부여 로직 포함.
       * MyGameplayAbility_Item.cpp: ApplyCooldown 및 GetCooldownTags 오버라이드로 슬롯별 독립 쿨타임 구현.
       * MyPlayerHUDWidget.cpp: SkillSlotMap 초기화 및 아이템 태그(Cooldown.Item.*) 리스너 등록.
       * MyGrenadeProjectile.cpp: 충돌 시 Spec 적용 및 GameplayCue 실행.
   * Blueprint/Asset:
       * GA_Item_xxx: CommitAbility 사용, Cooldown GE 연결됨.
       * GE_Cooldown_Base: 태그 비워둠 (코드 제어).
       * GCNL_TimeStop: 황금색 오버레이 머티리얼 연출.


[오늘 할일]
레벨(맵) 작업, 컷신고려
현재 구상도 : 로딩스크린(프리로드 고려), 메인메뉴에서 게임시작 버튼으로 레벨 진입, 처음시작 레벨은 상점 레벨. 상점에서 필요한 배틀아이템 구매후 실제 전투가 벌어지는 배틀레벨로 진입(배틀레벨에서는 아이템구매 불가)
보스 등장 컷신, 보스등장 컷신후 플레이어 화면에 나오는 WBP_BossInfo, 보스 처치시 컷신후 결과창(컷신이 끝날때부터 타이머를 돌려 처치시간 기록)과 게임종료버튼. 플레이어 사망시 재도전 버튼과 재정비 버튼과 게임종료버튼. 재도전버튼 클릭시 보스등장 컷신을 빼고 즉시 재도전 할 수 있게(배틀아이템 자동리필).
재정비 버튼 클릭시 상점레벨로 돌아가서 배틀아이템 재정비. 게임종료 버튼시 게임종료.

  ---

[남은 잔업 (로드맵 전부 구현 후 제작 목록)]
1. 보스 ai 보강
2. 보스 clap 패턴 장판 추가
3. 보스 피통 하단에 debuff ui 추가
4. 플레이어 피격모션 추가
5. 보스, 플레이어 hp 0 시 죽음
6. 보스 조우시 WBP_BossInfo를 wbp_myhudlayout에 추가하는식으로